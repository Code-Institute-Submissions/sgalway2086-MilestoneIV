{% extends "base.html" %}
{% load mathfilters %}
{% block content %}
<div class = "mobile-div-top">
    <div>
        <div id = "bag-wrap">
            {% if bag_items %}
            <div id = "bag-descriptions">
                <div class = "bag-desc-info">
                    <strong><p>Product Info</p></strong>
                </div>
                <div class = "bag-item-digits">
                    <strong><p>Price</p></strong>
                </div>
                <div class = "bag-item-digits">
                    <strong><p>Qty</p></strong>
                </div>
                <div class = "bag-item-digits">
                    <strong><p>Subtotal</p></strong>
                </div>
            </div>
            {% for item in bag_items %}
            {{ item }}
                <div class = "bag-item-wrap">
                    <div class = "bag-item-image">
                        <img src = "{{ item.product.image.url }}">
                    </div>
                    <div class = "bag-item-info">
                        <p class = "my-0">{{ item.product.name }}</p>
                        <p class = "text-muted">{{ item.product.sku|upper }}</p>
                        {% if item.product.has_sizes %}
                          <p class = "my-0">Size: {{ item.size|upper }}</p>
                        {% endif %} 
                    </div>
                    <div class = "bag-item-digits">
                        <p>${{ item.product.price }}</p>
                    </div>
                    <div class = "bag-item-digits">
                        <p>{{ item.quantity }}</p>
                        <form class = "form" action="{% url 'remove_from_bag' item.product.id %}" method = "POST">
                            {% csrf_token %}
                            <input type = "submit" value = "Remove">
                            <input type = "hidden" name = "redirect_url" value = "{{ request.path }}">
                        </form>
                    </div>
                    <div class = "bag-item-digits">
                        <p>${{ item.product.price|mul:item.quantity }}</p>
                    </div>
                </div>
            {% endfor %}
            <div id = "grand-total-div">
                <div>
                    <strong><h6>Total Price</h6></strong>
                    <p>{{ grand_total }}</p>
                </div>
            </div>
        </div>    
    </div>
    {% else %}
    <p class = "lead mb-5">Your bag is empty</p>
    <a href = "{% url 'shop' %}" class = "btn btn-outline-black rounded-0 btn-lg">
        <span class = "icon">
            <i class = "fas fa-chavron-left"></i>
        </span>
        <span class= "text-uppercase">Keep Shopping</span>
    </a>
    {% endif %}
</div>
{% endblock %}